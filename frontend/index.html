<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>Vision & Hearing Screening Form</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            font-weight: 300;
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .form-container {
            padding: 40px;
        }

        .form-section {
            margin-bottom: 30px;
            padding: 25px;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 12px;
            border: 2px solid #e1e8ed;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }

        .form-section h2 {
            color: #2c3e50;
            margin-bottom: 20px;
            font-size: 1.4rem;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
            text-shadow: 0 1px 2px rgba(0,0,0,0.1);
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #34495e;
        }

        .form-group input,
        .form-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid #bdc3c7;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s ease;
        }

        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 8px rgba(52, 152, 219, 0.3);
        }

        /* Student ID Search Container */
        .student-id-container {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .student-id-container input {
            flex: 1;
        }

        /* Tab-based Student Interface */
        .student-tabs {
            display: flex;
            border-bottom: 2px solid #e5e5e5;
            margin-bottom: 20px;
        }

        .tab-button {
            padding: 12px 30px;
            border: none;
            background: none;
            cursor: pointer;
            font-size: 16px;
            font-weight: 500;
            color: #666;
            border-bottom: 3px solid transparent;
            transition: all 0.3s;
        }

        .tab-button:hover {
            color: #4A90E2;
            background-color: #f8f9fa;
        }

        .tab-button.active {
            color: #4A90E2;
            border-bottom-color: #4A90E2;
        }

        .tab-content {
            padding: 20px 0;
        }

        .tab-panel {
            display: none;
        }

        .tab-panel.active {
            display: block;
        }

        .search-methods {
            margin-bottom: 20px;
        }

        .search-method {
            margin-bottom: 20px;
        }

        .search-input-group {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .search-input-group input {
            flex: 1;
        }

        .search-divider {
            text-align: center;
            margin: 20px 0;
            font-weight: 600;
            color: #666;
            position: relative;
        }

        .search-divider::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            height: 1px;
            background: #e5e5e5;
            z-index: 1;
        }

        .search-divider {
            background: white;
            padding: 0 20px;
            z-index: 2;
            position: relative;
        }

        .new-student-form {
            max-width: 800px;
            margin: 0 auto;
        }

        .help-text {
            color: #666;
            font-size: 14px;
            margin-bottom: 20px;
            font-style: italic;
        }

        .primary-button {
            background: linear-gradient(135deg, #27ae60, #2ecc71);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
            margin-top: 20px;
            box-shadow: 0 4px 8px rgba(39, 174, 96, 0.3);
            text-shadow: 0 1px 2px rgba(0,0,0,0.2);
        }

        .primary-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 16px rgba(39, 174, 96, 0.4);
            background: linear-gradient(135deg, #229954, #27ae60);
        }

        .primary-button:active {
            transform: translateY(0);
            box-shadow: 0 2px 4px rgba(39, 174, 96, 0.3);
        }

        /* Search Results Styling */
        .student-result {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            border: 1px solid #e5e5e5;
            border-radius: 8px;
            margin-bottom: 10px;
            background: #f8f9fa;
        }

        .student-info {
            flex: 1;
        }

        .select-button {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
        }

        .select-button:hover {
            background: linear-gradient(135deg, #2980b9, #1f5f8b);
        }

        .search-button {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            white-space: nowrap;
            box-shadow: 0 4px 8px rgba(52, 152, 219, 0.3);
            text-shadow: 0 1px 2px rgba(0,0,0,0.2);
        }

        .search-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(52, 152, 219, 0.4);
            background: linear-gradient(135deg, #2980b9, #1f5f8b);
        }

        .search-button:active {
            transform: translateY(0);
            box-shadow: 0 2px 4px rgba(52, 152, 219, 0.3);
        }

        .form-row {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
        }

        .form-row .form-group {
            flex: 1;
        }

        .pass-fail-group {
            margin-top: 10px;
        }

        .radio-group {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .radio-option {
            display: flex;
            align-items: center;
            padding: 12px 20px;
            border: 2px solid #bdc3c7;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            background: white;
            font-weight: 500;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .radio-option:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
        }

        .radio-option.pass {
            border-color: #27ae60;
            color: #27ae60;
            background: linear-gradient(135deg, #ffffff 0%, #d5f4e6 100%);
        }

        .radio-option.pass:hover {
            background: linear-gradient(135deg, #d5f4e6 0%, #a8e6cf 100%);
            box-shadow: 0 4px 8px rgba(39, 174, 96, 0.3);
        }

        .radio-option.failed {
            border-color: #e74c3c;
            color: #e74c3c;
            background: linear-gradient(135deg, #ffffff 0%, #fadbd8 100%);
        }

        .radio-option.failed:hover {
            background: linear-gradient(135deg, #fadbd8 0%, #f1948a 100%);
            box-shadow: 0 4px 8px rgba(231, 76, 60, 0.3);
        }

        .radio-option input[type="radio"] {
            margin-right: 8px;
            width: auto;
        }

        .radio-option.selected {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            border-color: #2980b9;
            box-shadow: 0 4px 8px rgba(52, 152, 219, 0.4);
            text-shadow: 0 1px 2px rgba(0,0,0,0.2);
        }

        .radio-option.selected.pass {
            background: linear-gradient(135deg, #27ae60, #229954);
            border-color: #229954;
            box-shadow: 0 4px 8px rgba(39, 174, 96, 0.4);
        }

        .radio-option.selected.failed {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            border-color: #c0392b;
            box-shadow: 0 4px 8px rgba(231, 76, 60, 0.4);
        }

        /* Screening Section Styles */
        .screening-section {
            border: 2px solid #e1e8ed;
            border-radius: 12px;
            margin-bottom: 20px;
            overflow: hidden;
            transition: all 0.3s ease;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }

        .section-header {
            padding: 20px;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s ease;
            border-bottom: 1px solid #dee2e6;
        }

        .section-header:hover {
            background: linear-gradient(135deg, #e9ecef 0%, #dee2e6 100%);
            transform: translateY(-1px);
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .section-header.active {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            text-shadow: 0 1px 2px rgba(0,0,0,0.2);
        }

        .section-title {
            font-size: 1.2rem;
            font-weight: 600;
        }

        .toggle-icon {
            font-size: 1.2rem;
            transition: transform 0.3s ease;
        }

        .section-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }

        .section-content.open {
            max-height: 2000px;
        }

        .section-inner {
            padding: 25px;
            background: linear-gradient(135deg, #fafbfc 0%, #f8f9fa 100%);
            border-top: 1px solid #e9ecef;
        }

        .day-content {
            display: block;
        }

        /* Absent Section */
        .absent-section {
            background: linear-gradient(135deg, #fff3cd 0%, #ffeaa7 100%);
            border: 2px solid #ffc107;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 25px;
            box-shadow: 0 4px 8px rgba(255, 193, 7, 0.2);
        }

        .absent-section h3 {
            color: #856404;
            margin-bottom: 15px;
            font-size: 1.2rem;
            text-shadow: 0 1px 2px rgba(0,0,0,0.1);
        }

        /* Screening Type Section */
        .screening-type-section {
            background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
            border: 2px solid #2196f3;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 25px;
            box-shadow: 0 4px 8px rgba(33, 150, 243, 0.2);
        }

        .screening-type-section h3 {
            color: #0d47a1;
            margin-bottom: 15px;
            font-size: 1.2rem;
            text-shadow: 0 1px 2px rgba(0,0,0,0.1);
        }

        /* Screener and Date Section */
        .screener-date-section {
            background: linear-gradient(135deg, #f3e5f5 0%, #e1bee7 100%);
            border: 2px solid #9c27b0;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 25px;
            box-shadow: 0 4px 8px rgba(156, 39, 176, 0.2);
        }

        .screener-date-section h3 {
            color: #4a148c;
            margin-bottom: 15px;
            font-size: 1.2rem;
            text-shadow: 0 1px 2px rgba(0,0,0,0.1);
        }

        .acuity-input {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .acuity-input span {
            font-weight: 600;
            color: #2c3e50;
        }

        .acuity-input select {
            width: auto;
            min-width: 80px;
        }

        .submit-button {
            background: linear-gradient(135deg, #27ae60, #2ecc71);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 8px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
            margin-top: 30px;
            box-shadow: 0 4px 8px rgba(39, 174, 96, 0.3);
            text-shadow: 0 1px 2px rgba(0,0,0,0.2);
        }

        .submit-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 16px rgba(39, 174, 96, 0.4);
            background: linear-gradient(135deg, #229954, #27ae60);
        }

        .submit-button:active {
            transform: translateY(0);
            box-shadow: 0 2px 4px rgba(39, 174, 96, 0.3);
        }

        .submit-button:disabled {
            background: linear-gradient(135deg, #bdc3c7, #95a5a6);
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        @media (max-width: 768px) {
            .form-row {
                flex-direction: column;
                gap: 10px;
            }
            
            .radio-group {
                flex-direction: column;
            }
            
            .container {
                margin: 10px;
                border-radius: 10px;
            }
            
            .form-container {
                padding: 20px;
            }

            .student-tabs {
                flex-direction: column;
            }

            .tab-button {
                border-bottom: none;
                border-right: 3px solid transparent;
                text-align: left;
            }

            .tab-button.active {
                border-bottom: none;
                border-right-color: #4A90E2;
            }

            .search-input-group {
                flex-direction: column;
            }

            .new-student-form {
                max-width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🏥 VHSA Health Screening Form</h1>
            <p>Comprehensive Vision, Hearing, Acanthosis Nigricans & Scoliosis Screening</p>
        </div>

        <div class="form-container">
            <form id="screeningForm">
                <!-- Student Information Section -->
                <div class="form-section">
                <h2>👤 Student Information</h2>
                    
                    <!-- Tab Navigation -->
                    <div class="student-tabs">
                        <button class="tab-button active" id="searchTab" onclick="switchTab('search')">
                            Search Student
                        </button>
                        <button class="tab-button" id="newStudentTab" onclick="switchTab('newStudent')">
                            New Student
                            </button>
                    </div>

                    <div class="tab-content">
                        
                        <!-- SEARCH STUDENT TAB -->
                        <div id="searchTabContent" class="tab-panel active">
                            <h3>Find Existing Student</h3>
                            
                            <div class="search-methods">
                                <!-- Search by ID -->
                                <div class="search-method">
                                    <label for="studentId">Student ID:</label>
                                    <div class="search-input-group">
                                        <input type="text" id="studentId" placeholder="e.g., st0100">
                                        <button type="button" class="search-button" onclick="searchById()">Search by ID</button>
                        </div>
                    </div>
                
                                <div class="search-divider">OR</div>
                                
                                <!-- Search by Name -->
                                <div class="search-method">
                        <div class="form-row">
                            <div class="form-group">
                                            <label for="searchLastName">Last Name:</label>
                                            <input type="text" id="searchLastName" placeholder="Enter last name">
                                        </div>
                                        
                                        <div class="form-group">
                                            <label for="searchSchool">School:</label>
                                            <select id="searchSchool">
                                                <option value="">Select School</option>
                                                <!-- Populated from API -->
                                            </select>
                                        </div>
                                    </div>
                                    
                                    <button type="button" class="search-button" onclick="searchByName()">Search by Name</button>
                                </div>
                            </div>
                            
                            <!-- Multiple results area -->
                            <div id="searchResults" style="display: none;"></div>
                        </div>
                        
                        <!-- NEW STUDENT TAB -->
                        <div id="newStudentTabContent" class="tab-panel" style="display: none;">
                            <h3>Create New Student</h3>
                            <p class="help-text">Fill in student information. A student ID will be automatically generated.</p>
                            
                            <div class="new-student-form">
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="newFirstName">First Name: *</label>
                                        <input type="text" id="newFirstName" required>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label for="newLastName">Last Name: *</label>
                                        <input type="text" id="newLastName" required>
                                    </div>
                                </div>
                                
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="newGrade">Grade: *</label>
                                        <select id="newGrade" required>
                                    <option value="">Select Grade</option>
                                    <option value="Pre-K (3)">Pre-K (3)</option>
                                    <option value="Pre-K (4)">Pre-K (4)</option>
                                    <option value="Kindergarten">Kindergarten</option>
                                    <option value="1st">1st</option>
                                    <option value="2nd">2nd</option>
                                    <option value="3rd">3rd</option>
                                    <option value="4th">4th</option>
                                    <option value="5th">5th</option>
                                    <option value="6th">6th</option>
                                    <option value="7th">7th</option>
                                    <option value="8th">8th</option>
                                    <option value="9th">9th</option>
                                    <option value="10th">10th</option>
                                    <option value="11th">11th</option>
                                    <option value="12th">12th</option>
                                </select>
                            </div>
                                    
                    <div class="form-group">
                                        <label for="newGender">Gender: *</label>
                                        <select id="newGender" required>
                                    <option value="">Select Gender</option>
                                    <option value="Male">Male</option>
                                    <option value="Female">Female</option>
                                    <option value="Other">Other</option>
                                </select>
                    </div>
                                </div>
                                
                                <div class="form-row">
                    <div class="form-group">
                                        <label for="newSchool">School: *</label>
                                        <select id="newSchool" required>
                                    <option value="">Select School</option>
                                            <!-- Populated from API -->
                                </select>
                            </div>
                                    
                            <div class="form-group">
                                        <label for="newTeacher">Teacher:</label>
                                        <input type="text" id="newTeacher">
                    </div>
                                </div>
                                
                                <div class="form-row">
                    <div class="form-group">
                                        <label for="newDOB">Date of Birth: *</label>
                                        <input type="date" id="newDOB" required>
                    </div>
                                    
                    <div class="form-group">
                                        <label for="newStatus">Status: *</label>
                                        <select id="newStatus" required>
                                    <option value="">Select Status</option>
                                    <option value="New">New</option>
                                    <option value="Returning">Returning</option>
                                </select>
                            </div>
                    </div>
                                
                                <button type="button" onclick="createNewStudent()" class="primary-button">
                                    Create Student & Continue
                                </button>
                </div>
            </div>

                    </div>

                    <!-- Student info section (appears after search OR create) -->
                    <div id="studentInfoSection" style="display: none;">
                        <h3>Student Information</h3>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="studentFirstName">First Name:</label>
                                <input type="text" id="studentFirstName" readonly>
                            </div>
                            <div class="form-group">
                                <label for="studentLastName">Last Name:</label>
                                <input type="text" id="studentLastName" readonly>
                </div>
            </div>

                <div class="form-row">
                    <div class="form-group">
                                <label for="studentGrade">Grade:</label>
                                <select id="studentGrade" disabled>
                                    <option value="">Select Grade</option>
                                    <option value="Pre-K (3)">Pre-K (3)</option>
                                    <option value="Pre-K (4)">Pre-K (4)</option>
                                    <option value="Kindergarten">Kindergarten</option>
                                    <option value="1st">1st</option>
                                    <option value="2nd">2nd</option>
                                    <option value="3rd">3rd</option>
                                    <option value="4th">4th</option>
                                    <option value="5th">5th</option>
                                    <option value="6th">6th</option>
                                    <option value="7th">7th</option>
                                    <option value="8th">8th</option>
                                    <option value="9th">9th</option>
                                    <option value="10th">10th</option>
                                    <option value="11th">11th</option>
                                    <option value="12th">12th</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="studentGender">Gender:</label>
                                <select id="studentGender" disabled>
                                    <option value="">Select Gender</option>
                                    <option value="Male">Male</option>
                                    <option value="Female">Female</option>
                            <option value="Other">Other</option>
                        </select>
                    </div>
                        </div>

                        <div class="form-row">
                    <div class="form-group">
                                <label for="studentSchool">School:</label>
                                <select id="studentSchool" disabled>
                                    <option value="">Select School</option>
                                </select>
                    </div>
                            <div class="form-group">
                                <label for="studentTeacher">Teacher:</label>
                                <input type="text" id="studentTeacher" readonly>
                    </div>
                </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="studentDOB">Date of Birth:</label>
                                <input type="date" id="studentDOB" readonly>
                            </div>
                            <div class="form-group">
                                <label for="studentStatus">Status:</label>
                                <select id="studentStatus" disabled>
                                    <option value="">Select Status</option>
                                    <option value="New">New</option>
                                    <option value="Returning">Returning</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Student Absent Section -->
                <div class="absent-section">
                    <h3>📋 Student Attendance</h3>
                    <div class="form-group">
                        <label>Was the student present for screening?</label>
                        <div class="pass-fail-group">
                            <div class="radio-group">
                                <label class="radio-option pass" onclick="handleAbsentChange(this, 'no')">
                                    <input type="radio" name="absent" value="no" checked>
                                    Present
                                </label>
                                <label class="radio-option failed" onclick="handleAbsentChange(this, 'yes')">
                                    <input type="radio" name="absent" value="yes">
                                    Absent
                                </label>
                            </div>
                    </div>
                </div>
            </div>

                <!-- Screening Type Section -->
                <div class="screening-type-section">
                    <h3>📅 Screening Type</h3>
                    <div class="form-group">
                        <div class="radio-group">
                            <label class="radio-option pass" onclick="selectRadio(this)">
                                <input type="radio" name="screeningType" value="day1" checked>
                                Initial Screening
                            </label>
                            <label class="radio-option failed" onclick="selectRadio(this)">
                                <input type="radio" name="screeningType" value="day2">
                                Rescreen
                            </label>
                        </div>
                    </div>
                </div>

                <!-- Screener and Date Section -->
                <div class="screener-date-section">
                    <h3>👩‍⚕️ Screener Information</h3>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="globalScreener">Screener Name:</label>
                            <select id="globalScreener" onchange="updateAllScreeners()">
                                <option value="">Select Screener</option>
                                <option value="Heather Broecklemann">Heather Broecklemann</option>
                                <option value="Katie Corlin">Katie Corlin</option>
                                <option value="Kristen Maracchini">Kristen Maracchini</option>
                                <option value="Tanja Saiidi">Tanja Saiidi</option>
                                <option value="Becki Sellers">Becki Sellers</option>
                                <option value="Lysette Reeves">Lysette Reeves</option>
                                <option value="Lynn Sawyer">Lynn Sawyer</option>
                                <option value="Erin Newman">Erin Newman</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="globalDate">Screening Date:</label>
                            <input type="date" id="globalDate" onchange="updateAllDates()">
                        </div>
                    </div>
                </div>

                <!-- Screening Tests Container -->
                <div id="screeningTestsContainer">
                    <!-- Vision Screening -->
                    <div id="visionSection" class="screening-section" data-section="vision">
                        <div class="section-header">
                            <span class="section-title">👁️ Vision Screening</span>
                            <span class="toggle-icon">▶</span>
                        </div>
                        <div class="section-content" id="vision-content">
                            <div class="section-inner">
                                <!-- Day 1 (Initial Screening) -->
                                <div id="visionDay1" class="day-content">
                                    <div class="form-group">
                        <label>Screening Type:</label>
                                        <div class="radio-group">
                                            <label class="radio-option pass" onclick="selectRadio(this)">
                                                <input type="radio" name="visionDay1Type" value="initial" checked>
                                                Initial Screen
                                            </label>
                                            <label class="radio-option failed" onclick="selectRadio(this)">
                                                <input type="radio" name="visionDay1Type" value="rescreen">
                                                Rescreen
                                            </label>
                                        </div>
                </div>
                                    <div class="form-group">
                        <label for="visionScreener1">Screener:</label>
                                        <select id="visionScreener1">
                                            <option value="">Select Screener</option>
                                            <option value="Heather Broecklemann">Heather Broecklemann</option>
                                            <option value="Katie Corlin">Katie Corlin</option>
                                            <option value="Kristen Maracchini">Kristen Maracchini</option>
                                            <option value="Tanja Saiidi">Tanja Saiidi</option>
                                            <option value="Becki Sellers">Becki Sellers</option>
                                            <option value="Lysette Reeves">Lysette Reeves</option>
                                            <option value="Lynn Sawyer">Lynn Sawyer</option>
                                            <option value="Erin Newman">Erin Newman</option>
                                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label>Wearing glasses/contacts during test?</label>
                        <div class="pass-fail-group">
                            <div class="radio-group">
                                                <label class="radio-option" onclick="selectRadio(this)">
                                    <input type="radio" name="glassesDay1" value="yes">
                                    Yes
                                </label>
                                                <label class="radio-option" onclick="selectRadio(this)">
                                    <input type="radio" name="glassesDay1" value="no">
                                    No
                                </label>
                            </div>
                        </div>
                    </div>

                    <div style="border-top: 2px solid #3498db; padding-top: 20px; margin-top: 20px;">
                        <label style="font-weight: bold; font-size: 1.15rem; color: #2c3e50; display: block; margin-bottom: 10px;">👁️ Overall Vision Results:</label>
                        <div class="pass-fail-group">
                            <div class="radio-group">
                                <label class="radio-option pass" onclick="selectRadio(this); handleVisionResult('pass', 'Day1')">
                                    <input type="radio" name="visionResultDay1" value="pass">
                                    Pass
                                </label>
                                <label class="radio-option failed" onclick="selectRadio(this); handleVisionResult('fail', 'Day1')">
                                    <input type="radio" name="visionResultDay1" value="fail">
                                    Fail
                                </label>
                            </div>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Right Eye Acuity:</label>
                            <div class="acuity-input">
                                <span>20/</span>
                                <select id="rightEyeDay1">
                                    <option value="">Select</option>
                                    <option value="20">20</option>
                                    <option value="30">30</option>
                                    <option value="40">40</option>
                                    <option value="50">50</option>
                                    <option value="60">60</option>
                                    <option value="70">70</option>
                                    <option value="80">80</option>
                                    <option value="90">90</option>
                                    <option value="100">100</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Left Eye Acuity:</label>
                            <div class="acuity-input">
                                <span>20/</span>
                                <select id="leftEyeDay1">
                                    <option value="">Select</option>
                                    <option value="20">20</option>
                                    <option value="30">30</option>
                                    <option value="40">40</option>
                                    <option value="50">50</option>
                                    <option value="60">60</option>
                                    <option value="70">70</option>
                                    <option value="80">80</option>
                                    <option value="90">90</option>
                                    <option value="100">100</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>

                                <!-- Day 2 (Rescreen) -->
                                <div id="visionDay2" class="day-content" style="display: none;">
                                    <div class="form-group">
                        <label>Screening Type:</label>
                                        <div class="radio-group">
                                            <label class="radio-option pass" onclick="selectRadio(this)">
                                                <input type="radio" name="visionDay2Type" value="initial" checked>
                                                Initial Screen
                                            </label>
                                            <label class="radio-option failed" onclick="selectRadio(this)">
                                                <input type="radio" name="visionDay2Type" value="rescreen">
                                                Rescreen
                                            </label>
                                        </div>
                    </div>
                                    <div class="form-group">
                        <label for="visionScreener2">Screener:</label>
                        <select id="visionScreener2">
                            <option value="">Select Screener</option>
                            <option value="Heather Broecklemann">Heather Broecklemann</option>
                            <option value="Katie Corlin">Katie Corlin</option>
                            <option value="Kristen Maracchini">Kristen Maracchini</option>
                            <option value="Tanja Saiidi">Tanja Saiidi</option>
                            <option value="Becki Sellers">Becki Sellers</option>
                            <option value="Lysette Reeves">Lysette Reeves</option>
                            <option value="Lynn Sawyer">Lynn Sawyer</option>
                            <option value="Erin Newman">Erin Newman</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label>Wearing glasses/contacts during test?</label>
                        <div class="pass-fail-group">
                            <div class="radio-group">
                                <label class="radio-option" onclick="selectRadio(this)">
                                    <input type="radio" name="glassesDay2" value="yes">
                                    Yes
                                </label>
                                <label class="radio-option" onclick="selectRadio(this)">
                                    <input type="radio" name="glassesDay2" value="no">
                                    No
                                </label>
                            </div>
                        </div>
                    </div>

                    <div style="border-top: 2px solid #3498db; padding-top: 20px; margin-top: 20px;">
                        <label style="font-weight: bold; font-size: 1.15rem; color: #2c3e50; display: block; margin-bottom: 10px;">👁️ Overall Vision Results:</label>
                        <div class="pass-fail-group">
                            <div class="radio-group">
                                <label class="radio-option pass" onclick="selectRadio(this); handleVisionResult('pass', 'Day2')">
                                    <input type="radio" name="visionResultDay2" value="pass">
                                    Pass
                                </label>
                                <label class="radio-option failed" onclick="selectRadio(this); handleVisionResult('fail', 'Day2')">
                                    <input type="radio" name="visionResultDay2" value="fail">
                                    Fail
                                </label>
                            </div>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Right Eye Acuity:</label>
                            <div class="acuity-input">
                                <span>20/</span>
                                <select id="rightEyeDay2">
                                    <option value="">Select</option>
                                    <option value="20">20</option>
                                    <option value="30">30</option>
                                    <option value="40">40</option>
                                    <option value="50">50</option>
                                    <option value="60">60</option>
                                    <option value="70">70</option>
                                    <option value="80">80</option>
                                    <option value="90">90</option>
                                    <option value="100">100</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Left Eye Acuity:</label>
                            <div class="acuity-input">
                                <span>20/</span>
                                <select id="leftEyeDay2">
                                    <option value="">Select</option>
                                    <option value="20">20</option>
                                    <option value="30">30</option>
                                    <option value="40">40</option>
                                    <option value="50">50</option>
                                    <option value="60">60</option>
                                    <option value="70">70</option>
                                    <option value="80">80</option>
                                    <option value="90">90</option>
                                    <option value="100">100</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
                    </div>
                </div>
            </div>

                    <!-- Hearing Screening -->
                    <div id="hearingSection" class="screening-section" data-section="hearing">
                        <div class="section-header">
                            <span class="section-title">👂 Hearing Screening</span>
                            <span class="toggle-icon">▶</span>
                        </div>
                        <div class="section-content" id="hearing-content">
                            <div class="section-inner">
                                <!-- Day 1 (Initial Screening) -->
                                <div id="hearingDay1" class="day-content">
                                    <div class="form-group">
                        <label>Screening Type:</label>
                                        <div class="radio-group">
                                            <label class="radio-option pass" onclick="selectRadio(this)">
                                                <input type="radio" name="hearingDay1Type" value="initial" checked>
                                                Initial Screen
                                            </label>
                                            <label class="radio-option failed" onclick="selectRadio(this)">
                                                <input type="radio" name="hearingDay1Type" value="rescreen">
                                                Rescreen
                                            </label>
                                        </div>
                </div>
                                    <div class="form-group">
                        <label for="hearingScreener1">Screener:</label>
                                        <select id="hearingScreener1">
                                            <option value="">Select Screener</option>
                                            <option value="Heather Broecklemann">Heather Broecklemann</option>
                                            <option value="Katie Corlin">Katie Corlin</option>
                                            <option value="Kristen Maracchini">Kristen Maracchini</option>
                                            <option value="Tanja Saiidi">Tanja Saiidi</option>
                                            <option value="Becki Sellers">Becki Sellers</option>
                                            <option value="Lysette Reeves">Lysette Reeves</option>
                                            <option value="Lynn Sawyer">Lynn Sawyer</option>
                                            <option value="Erin Newman">Erin Newman</option>
                                        </select>
                    </div>

                    <div style="background: #e8f5e9; padding: 15px; border-radius: 8px; margin-bottom: 20px; text-align: center; border: 2px solid #4caf50;">
                        <strong style="color: #2e7d32; font-size: 1.1rem;">Testing Level: 25 dL</strong>
                    </div>

                    <div style="border-top: 2px solid #3498db; padding-top: 20px; margin-top: 20px;">
                        <label style="font-weight: bold; font-size: 1.15rem; color: #2c3e50; display: block; margin-bottom: 10px;">📊 Overall Hearing Results:</label>
                        <div class="pass-fail-group">
                            <div class="radio-group">
                                <label class="radio-option pass" onclick="selectRadio(this); handleHearingResult('pass', 'Day1')">
                                    <input type="radio" name="hearingResultDay1" value="pass">
                                    Pass
                                </label>
                                <label class="radio-option failed" onclick="selectRadio(this); handleHearingResult('fail', 'Day1')">
                                    <input type="radio" name="hearingResultDay1" value="fail">
                                    Fail
                                </label>
                            </div>
                        </div>
                    </div>

                                    <!-- Frequency-specific results (shown when Fail is selected) -->
                                    <div id="hearingFrequenciesDay1" style="display: none; margin-top: 20px; padding: 20px; background: #fff3cd; border: 2px solid #ffc107; border-radius: 8px;">
                                        <h4 style="color: #856404; margin-bottom: 15px;">Frequency-Specific Results:</h4>
                                        
                                        <div class="form-row">
                                    <div class="form-group">
                                                <label>Right Ear - 1000 Hz:</label>
                                            <div class="radio-group">
                                                <label class="radio-option pass" onclick="selectRadio(this)">
                                                    <input type="radio" name="hearingRight1000Day1" value="pass">
                                                    Pass
                                                </label>
                                                <label class="radio-option failed" onclick="selectRadio(this)">
                                                    <input type="radio" name="hearingRight1000Day1" value="fail">
                                                    Fail
                                                </label>
                                            </div>
                                        </div>
                                    <div class="form-group">
                                                <label>Right Ear - 2000 Hz:</label>
                                            <div class="radio-group">
                                                <label class="radio-option pass" onclick="selectRadio(this)">
                                                    <input type="radio" name="hearingRight2000Day1" value="pass">
                                                    Pass
                                                </label>
                                                <label class="radio-option failed" onclick="selectRadio(this)">
                                                    <input type="radio" name="hearingRight2000Day1" value="fail">
                                                    Fail
                                                </label>
                                            </div>
                                        </div>
                                    <div class="form-group">
                                                <label>Right Ear - 4000 Hz:</label>
                                            <div class="radio-group">
                                                <label class="radio-option pass" onclick="selectRadio(this)">
                                                    <input type="radio" name="hearingRight4000Day1" value="pass">
                                                    Pass
                                                </label>
                                                <label class="radio-option failed" onclick="selectRadio(this)">
                                                    <input type="radio" name="hearingRight4000Day1" value="fail">
                                                    Fail
                                                </label>
                                            </div>
                                        </div>
                                    </div>

                                        <div class="form-row">
                                    <div class="form-group">
                                                <label>Left Ear - 1000 Hz:</label>
                                            <div class="radio-group">
                                                <label class="radio-option pass" onclick="selectRadio(this)">
                                                    <input type="radio" name="hearingLeft1000Day1" value="pass">
                                                    Pass
                                                </label>
                                                <label class="radio-option failed" onclick="selectRadio(this)">
                                                    <input type="radio" name="hearingLeft1000Day1" value="fail">
                                                    Fail
                                                </label>
                                            </div>
                                        </div>
                                    <div class="form-group">
                                                <label>Left Ear - 2000 Hz:</label>
                                            <div class="radio-group">
                                                <label class="radio-option pass" onclick="selectRadio(this)">
                                                    <input type="radio" name="hearingLeft2000Day1" value="pass">
                                                    Pass
                                                </label>
                                                <label class="radio-option failed" onclick="selectRadio(this)">
                                                    <input type="radio" name="hearingLeft2000Day1" value="fail">
                                                    Fail
                                                </label>
                                            </div>
                                        </div>
                                    <div class="form-group">
                                                <label>Left Ear - 4000 Hz:</label>
                                            <div class="radio-group">
                                                <label class="radio-option pass" onclick="selectRadio(this)">
                                                    <input type="radio" name="hearingLeft4000Day1" value="pass">
                                                    Pass
                                                </label>
                                                <label class="radio-option failed" onclick="selectRadio(this)">
                                                    <input type="radio" name="hearingLeft4000Day1" value="fail">
                                                    Fail
                                                </label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Day 2 (Rescreen) -->
                                <div id="hearingDay2" class="day-content" style="display: none;">
                                    <div class="form-group">
                        <label>Screening Type:</label>
                                        <div class="radio-group">
                                            <label class="radio-option pass" onclick="selectRadio(this)">
                                                <input type="radio" name="hearingDay2Type" value="initial" checked>
                                                Initial Screen
                                            </label>
                                            <label class="radio-option failed" onclick="selectRadio(this)">
                                                <input type="radio" name="hearingDay2Type" value="rescreen">
                                                Rescreen
                                            </label>
                                        </div>
                    </div>
                                    <div class="form-group">
                        <label for="hearingScreener2">Screener:</label>
                        <select id="hearingScreener2">
                            <option value="">Select Screener</option>
                            <option value="Heather Broecklemann">Heather Broecklemann</option>
                            <option value="Katie Corlin">Katie Corlin</option>
                            <option value="Kristen Maracchini">Kristen Maracchini</option>
                            <option value="Tanja Saiidi">Tanja Saiidi</option>
                            <option value="Becki Sellers">Becki Sellers</option>
                            <option value="Lysette Reeves">Lysette Reeves</option>
                            <option value="Lynn Sawyer">Lynn Sawyer</option>
                            <option value="Erin Newman">Erin Newman</option>
                        </select>
                    </div>

                    <div style="background: #e8f5e9; padding: 15px; border-radius: 8px; margin-bottom: 20px; text-align: center; border: 2px solid #4caf50;">
                        <strong style="color: #2e7d32; font-size: 1.1rem;">Testing Level: 25 dL</strong>
                    </div>

                    <div style="border-top: 2px solid #3498db; padding-top: 20px; margin-top: 20px;">
                        <label style="font-weight: bold; font-size: 1.15rem; color: #2c3e50; display: block; margin-bottom: 10px;">📊 Overall Hearing Results:</label>
                        <div class="pass-fail-group">
                            <div class="radio-group">
                                <label class="radio-option pass" onclick="selectRadio(this); handleHearingResult('pass', 'Day2')">
                                    <input type="radio" name="hearingResultDay2" value="pass">
                                    Pass
                                </label>
                                <label class="radio-option failed" onclick="selectRadio(this); handleHearingResult('fail', 'Day2')">
                                    <input type="radio" name="hearingResultDay2" value="fail">
                                    Fail
                                </label>
                            </div>
                        </div>
                    </div>

                                    <!-- Frequency-specific results (shown when Fail is selected) -->
                                    <div id="hearingFrequenciesDay2" style="display: none; margin-top: 20px; padding: 20px; background: #fff3cd; border: 2px solid #ffc107; border-radius: 8px;">
                                        <h4 style="color: #856404; margin-bottom: 15px;">Frequency-Specific Results:</h4>
                    
                                        <div class="form-row">
                    <div class="form-group">
                                                <label>Right Ear - 1000 Hz:</label>
                            <div class="radio-group">
                                <label class="radio-option pass" onclick="selectRadio(this)">
                                    <input type="radio" name="hearingRight1000Day2" value="pass">
                                    Pass
                                </label>
                                <label class="radio-option failed" onclick="selectRadio(this)">
                                    <input type="radio" name="hearingRight1000Day2" value="fail">
                                    Fail
                                </label>
                            </div>
                        </div>
                    <div class="form-group">
                                                <label>Right Ear - 2000 Hz:</label>
                            <div class="radio-group">
                                <label class="radio-option pass" onclick="selectRadio(this)">
                                    <input type="radio" name="hearingRight2000Day2" value="pass">
                                    Pass
                                </label>
                                <label class="radio-option failed" onclick="selectRadio(this)">
                                    <input type="radio" name="hearingRight2000Day2" value="fail">
                                    Fail
                                </label>
                            </div>
                        </div>
                    <div class="form-group">
                                                <label>Right Ear - 4000 Hz:</label>
                            <div class="radio-group">
                                <label class="radio-option pass" onclick="selectRadio(this)">
                                    <input type="radio" name="hearingRight4000Day2" value="pass">
                                    Pass
                                </label>
                                <label class="radio-option failed" onclick="selectRadio(this)">
                                    <input type="radio" name="hearingRight4000Day2" value="fail">
                                    Fail
                                </label>
                            </div>
                        </div>
                    </div>

                                        <div class="form-row">
                    <div class="form-group">
                                                <label>Left Ear - 1000 Hz:</label>
                            <div class="radio-group">
                                <label class="radio-option pass" onclick="selectRadio(this)">
                                    <input type="radio" name="hearingLeft1000Day2" value="pass">
                                    Pass
                                </label>
                                <label class="radio-option failed" onclick="selectRadio(this)">
                                    <input type="radio" name="hearingLeft1000Day2" value="fail">
                                    Fail
                                </label>
                            </div>
                        </div>
                    <div class="form-group">
                                                <label>Left Ear - 2000 Hz:</label>
                            <div class="radio-group">
                                <label class="radio-option pass" onclick="selectRadio(this)">
                                    <input type="radio" name="hearingLeft2000Day2" value="pass">
                                    Pass
                                </label>
                                <label class="radio-option failed" onclick="selectRadio(this)">
                                    <input type="radio" name="hearingLeft2000Day2" value="fail">
                                    Fail
                                </label>
                            </div>
                        </div>
                    <div class="form-group">
                                                <label>Left Ear - 4000 Hz:</label>
                            <div class="radio-group">
                                <label class="radio-option pass" onclick="selectRadio(this)">
                                    <input type="radio" name="hearingLeft4000Day2" value="pass">
                                    Pass
                                </label>
                                <label class="radio-option failed" onclick="selectRadio(this)">
                                    <input type="radio" name="hearingLeft4000Day2" value="fail">
                                    Fail
                                </label>
                            </div>
                            </div>
                        </div>
                    </div>
                </div>
                        </div>
                </div>
            </div>

                    <!-- Acanthosis Nigricans Screening -->
                    <div id="acanthosisSection" class="screening-section" data-section="acanthosis">
                        <div class="section-header">
                            <span class="section-title">🔬 Acanthosis Nigricans Screening</span>
                            <span class="toggle-icon">▶</span>
                        </div>
                        <div class="section-content" id="acanthosis-content">
                            <div class="section-inner">
                                <!-- Day 1 (Initial Screening) -->
                                <div id="acanthosisDay1" class="day-content">
                                    <div class="form-group">
                        <label>Screening Type:</label>
                                        <div class="radio-group">
                                            <label class="radio-option pass" onclick="selectRadio(this)">
                                                <input type="radio" name="acanthosisDay1Type" value="initial" checked>
                                                Initial Screen
                                            </label>
                                            <label class="radio-option failed" onclick="selectRadio(this)">
                                                <input type="radio" name="acanthosisDay1Type" value="rescreen">
                                                Rescreen
                                            </label>
                                        </div>
                </div>
                    <div class="form-group">
                        <label for="acanthosisScreener1">Screener:</label>
                                        <select id="acanthosisScreener1">
                                            <option value="">Select Screener</option>
                                            <option value="Heather Broecklemann">Heather Broecklemann</option>
                                            <option value="Katie Corlin">Katie Corlin</option>
                                            <option value="Kristen Maracchini">Kristen Maracchini</option>
                                            <option value="Tanja Saiidi">Tanja Saiidi</option>
                                            <option value="Becki Sellers">Becki Sellers</option>
                                            <option value="Lysette Reeves">Lysette Reeves</option>
                                            <option value="Lynn Sawyer">Lynn Sawyer</option>
                                            <option value="Erin Newman">Erin Newman</option>
                                        </select>
                    </div>

                    <div style="border-top: 2px solid #3498db; padding-top: 20px; margin-top: 20px;">
                                        <label style="font-weight: bold; font-size: 1.15rem; color: #2c3e50; display: block; margin-bottom: 10px;">🔬 Acanthosis Nigricans Results:</label>
                        <div class="pass-fail-group">
                            <div class="radio-group">
                                <label class="radio-option pass" onclick="selectRadio(this)">
                                    <input type="radio" name="acanthosisResultDay1" value="pass">
                                                    Pass (Not Present)
                                </label>
                                                <label class="radio-option failed" onclick="selectRadio(this)">
                                    <input type="radio" name="acanthosisResultDay1" value="fail">
                                                    Fail (Present)
                                </label>
                            </div>
                        </div>
                    </div>
                </div>

                                <!-- Day 2 (Rescreen) -->
                                <div id="acanthosisDay2" class="day-content" style="display: none;">
                                    <div class="form-group">
                        <label>Screening Type:</label>
                                        <div class="radio-group">
                                            <label class="radio-option pass" onclick="selectRadio(this)">
                                                <input type="radio" name="acanthosisDay2Type" value="initial" checked>
                                                Initial Screen
                                            </label>
                                            <label class="radio-option failed" onclick="selectRadio(this)">
                                                <input type="radio" name="acanthosisDay2Type" value="rescreen">
                                                Rescreen
                                            </label>
                                        </div>
                    </div>
                    <div class="form-group">
                        <label for="acanthosisScreener2">Screener:</label>
                                        <select id="acanthosisScreener2">
                                            <option value="">Select Screener</option>
                                            <option value="Heather Broecklemann">Heather Broecklemann</option>
                                            <option value="Katie Corlin">Katie Corlin</option>
                                            <option value="Kristen Maracchini">Kristen Maracchini</option>
                                            <option value="Tanja Saiidi">Tanja Saiidi</option>
                                            <option value="Becki Sellers">Becki Sellers</option>
                                            <option value="Lysette Reeves">Lysette Reeves</option>
                                            <option value="Lynn Sawyer">Lynn Sawyer</option>
                                            <option value="Erin Newman">Erin Newman</option>
                                        </select>
                    </div>

                    <div style="border-top: 2px solid #3498db; padding-top: 20px; margin-top: 20px;">
                                        <label style="font-weight: bold; font-size: 1.15rem; color: #2c3e50; display: block; margin-bottom: 10px;">🔬 Acanthosis Nigricans Results:</label>
                        <div class="pass-fail-group">
                            <div class="radio-group">
                                <label class="radio-option pass" onclick="selectRadio(this)">
                                    <input type="radio" name="acanthosisResultDay2" value="pass">
                                                    Pass (Not Present)
                                </label>
                                                <label class="radio-option failed" onclick="selectRadio(this)">
                                    <input type="radio" name="acanthosisResultDay2" value="fail">
                                                    Fail (Present)
                                </label>
                                            </div>
                                        </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

                    <!-- Scoliosis Screening -->
                    <div id="scoliosisSection" class="screening-section" data-section="scoliosis">
                        <div class="section-header">
                            <span class="section-title">🦴 Scoliosis Screening</span>
                            <span class="toggle-icon">▶</span>
                        </div>
                        <div class="section-content" id="scoliosis-content">
                            <div class="section-inner">
                                <!-- Day 1 (Initial Screening) -->
                                <div id="scoliosisDay1" class="day-content">
                                    <div class="form-group">
                        <label>Screening Type:</label>
                                        <div class="radio-group">
                                            <label class="radio-option pass" onclick="selectRadio(this)">
                                                <input type="radio" name="scoliosisDay1Type" value="initial" checked>
                                                Initial Screen
                                            </label>
                                            <label class="radio-option failed" onclick="selectRadio(this)">
                                                <input type="radio" name="scoliosisDay1Type" value="rescreen">
                                                Rescreen
                                            </label>
                                        </div>
                </div>
                                    <div class="form-group">
                        <label for="scoliosisScreener1">Screener:</label>
                                        <select id="scoliosisScreener1">
                                            <option value="">Select Screener</option>
                                            <option value="Heather Broecklemann">Heather Broecklemann</option>
                                            <option value="Katie Corlin">Katie Corlin</option>
                                            <option value="Kristen Maracchini">Kristen Maracchini</option>
                                            <option value="Tanja Saiidi">Tanja Saiidi</option>
                                            <option value="Becki Sellers">Becki Sellers</option>
                                            <option value="Lysette Reeves">Lysette Reeves</option>
                                            <option value="Lynn Sawyer">Lynn Sawyer</option>
                                            <option value="Erin Newman">Erin Newman</option>
                                        </select>
                    </div>

                    <div style="border-top: 2px solid #3498db; padding-top: 20px; margin-top: 20px;">
                                        <label style="font-weight: bold; font-size: 1.15rem; color: #2c3e50; display: block; margin-bottom: 10px;">🦴 Scoliosis Results:</label>
                        <div class="pass-fail-group">
                            <div class="radio-group">
                                <label class="radio-option pass" onclick="selectRadio(this)">
                                    <input type="radio" name="scoliosisResultDay1" value="pass">
                                                    Pass (No Scoliosis)
                                </label>
                                                <label class="radio-option failed" onclick="selectRadio(this)">
                                    <input type="radio" name="scoliosisResultDay1" value="fail">
                                                    Fail (Scoliosis Present)
                                </label>
                            </div>
                        </div>
                    </div>
                </div>

                                <!-- Day 2 (Rescreen) -->
                                <div id="scoliosisDay2" class="day-content" style="display: none;">
                                    <div class="form-group">
                        <label>Screening Type:</label>
                                        <div class="radio-group">
                                            <label class="radio-option pass" onclick="selectRadio(this)">
                                                <input type="radio" name="scoliosisDay2Type" value="initial" checked>
                                                Initial Screen
                                            </label>
                                            <label class="radio-option failed" onclick="selectRadio(this)">
                                                <input type="radio" name="scoliosisDay2Type" value="rescreen">
                                                Rescreen
                                            </label>
                                        </div>
                    </div>
                                    <div class="form-group">
                        <label for="scoliosisScreener2">Screener:</label>
                        <select id="scoliosisScreener2">
                            <option value="">Select Screener</option>
                            <option value="Heather Broecklemann">Heather Broecklemann</option>
                            <option value="Katie Corlin">Katie Corlin</option>
                            <option value="Kristen Maracchini">Kristen Maracchini</option>
                            <option value="Tanja Saiidi">Tanja Saiidi</option>
                            <option value="Becki Sellers">Becki Sellers</option>
                            <option value="Lysette Reeves">Lysette Reeves</option>
                            <option value="Lynn Sawyer">Lynn Sawyer</option>
                            <option value="Erin Newman">Erin Newman</option>
                        </select>
                    </div>

                    <div style="border-top: 2px solid #3498db; padding-top: 20px; margin-top: 20px;">
                                        <label style="font-weight: bold; font-size: 1.15rem; color: #2c3e50; display: block; margin-bottom: 10px;">🦴 Scoliosis Results:</label>
                        <div class="pass-fail-group">
                            <div class="radio-group">
                                <label class="radio-option pass" onclick="selectRadio(this)">
                                    <input type="radio" name="scoliosisResultDay2" value="pass">
                                                    Pass (No Scoliosis)
                                </label>
                                <label class="radio-option failed" onclick="selectRadio(this)">
                                    <input type="radio" name="scoliosisResultDay2" value="fail">
                                                    Fail (Scoliosis Present)
                                </label>
                            </div>
                        </div>
                    </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

                <button type="submit" class="submit-button">Submit Screening Results</button>
            </form>
        </div>
    </div>

    <script>
        // Backend API URLs
        const API_BASE = window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1' 
            ? 'http://localhost:3000/api' 
            : '/api';

        // Initialize collapsible sections
        function initializeCollapsibleSections() {
            document.querySelectorAll('.section-header').forEach(header => {
                header.addEventListener('click', function() {
                    const section = this.closest('.screening-section');
                    const content = section.querySelector('.section-content');
                    const icon = section.querySelector('.toggle-icon');
                    
                    const isOpen = content.classList.contains('open');
                    
                    if (isOpen) {
                content.classList.remove('open');
                icon.textContent = '▶';
                        this.classList.remove('active');
            } else {
                content.classList.add('open');
                icon.textContent = '▼';
                        this.classList.add('active');
                    }
                });
            });
        }

        // Handle screening type change (Initial/Rescreen)
        function handleScreeningTypeChange() {
            const screeningType = document.querySelector('input[name="screeningType"]:checked').value;
            
            // Show/hide day content based on screening type
            document.querySelectorAll('.day-content').forEach(dayContent => {
                if (dayContent.id.includes(screeningType)) {
                    dayContent.style.display = 'block';
                } else {
                    dayContent.style.display = 'none';
                }
            });
            
            // Update all individual screening type radio buttons
            const individualRadioGroups = [
                'visionDay1Type', 'visionDay2Type',
                'hearingDay1Type', 'hearingDay2Type', 
                'acanthosisDay1Type', 'acanthosisDay2Type',
                'scoliosisDay1Type', 'scoliosisDay2Type'
            ];
            
            individualRadioGroups.forEach(radioGroupName => {
                const radioButtons = document.querySelectorAll(`input[name="${radioGroupName}"]`);
                const value = screeningType === 'day1' ? 'initial' : 'rescreen';
                
                radioButtons.forEach(radio => {
                    if (radio.value === value) {
                        radio.checked = true;
                        // Trigger the selectRadio function to update styling
                        selectRadio(radio.closest('label'));
                    }
                });
            });
            
            // Re-apply global screener and date when switching days
            updateAllScreeners();
            updateAllDates();
        }

        // Update all screener dropdowns with global selection
        function updateAllScreeners() {
            const globalScreener = document.getElementById('globalScreener').value;
            const screeningType = document.querySelector('input[name="screeningType"]:checked').value;
            const daySuffix = screeningType === 'day1' ? '1' : '2';
            
            // Update all screener dropdowns for the active day
            const screenerDropdowns = [
                `visionScreener${daySuffix}`,
                `hearingScreener${daySuffix}`,
                `acanthosisScreener${daySuffix}`,
                `scoliosisScreener${daySuffix}`
            ];
            
            screenerDropdowns.forEach(dropdownId => {
                const dropdown = document.getElementById(dropdownId);
                if (dropdown) {
                    dropdown.value = globalScreener;
                }
            });
        }

        // Update all date fields with global date
        function updateAllDates() {
            const globalDate = document.getElementById('globalDate').value;
            const screeningType = document.querySelector('input[name="screeningType"]:checked').value;
            const daySuffix = screeningType === 'day1' ? '1' : '2';
            
            // Update all date fields for the active day
            const dateFields = [
                `visionDate${daySuffix}`,
                `hearingDate${daySuffix}`,
                `acanthosisDate${daySuffix}`,
                `scoliosisDate${daySuffix}`
            ];
            
            dateFields.forEach(fieldId => {
                const field = document.getElementById(fieldId);
                if (field) {
                    field.value = globalDate;
                }
            });
        }

        // Initialize screening type change listener
        function initializeScreeningTypeListener() {
            document.querySelectorAll('input[name="screeningType"]').forEach(radio => {
                radio.addEventListener('change', handleScreeningTypeChange);
            });
        }

        // Radio button selection handler
        function selectRadio(element) {
            // Remove selected class from siblings
            const siblings = element.parentElement.querySelectorAll('.radio-option');
            siblings.forEach(sibling => sibling.classList.remove('selected'));
            
            // Add selected class to clicked element
            element.classList.add('selected');
            
            // Set the radio button as checked
            const radio = element.querySelector('input[type="radio"]');
            if (radio) {
                radio.checked = true;
            }
        }

        // Handle absent/present change
        function handleAbsentChange(element, value) {
            selectRadio(element);
            
            const screeningTestsContainer = document.getElementById('screeningTestsContainer');
            if (value === 'yes') {
                // Student is absent - hide all screening sections
                screeningTestsContainer.style.display = 'none';
            } else {
                // Student is present - show screening sections
                screeningTestsContainer.style.display = 'block';
            }
        }

        // Handle vision result change
        function handleVisionResult(result, day) {
            // This function can be expanded to show/hide additional fields based on result
            console.log(`Vision ${result} for ${day}`);
        }

        // Handle hearing result change
        function handleHearingResult(result, day) {
            const frequenciesDiv = document.getElementById(`hearingFrequencies${day}`);
            if (frequenciesDiv) {
                if (result === 'fail') {
                    frequenciesDiv.style.display = 'block';
                } else {
                    frequenciesDiv.style.display = 'none';
                }
            }
        }

        // Check if section is open
        function isSectionOpen(section) {
            const content = document.getElementById(`${section}-content`);
            return content && content.classList.contains('open');
        }

        // Gather screening data for a specific section
        function gatherScreeningData(sectionName) {
            const screeningType = document.querySelector('input[name="screeningType"]:checked').value;
            const daySuffix = screeningType === 'day1' ? '1' : '2';
            
            const data = {
                type: document.querySelector(`input[name="${sectionName}Day${daySuffix}Type"]:checked`)?.value,
                screener: document.getElementById(`${sectionName}Screener${daySuffix}`)?.value,
                result: document.querySelector(`input[name="${sectionName}ResultDay${daySuffix}"]:checked`)?.value
            };
            
            // Add section-specific data
            if (sectionName === 'vision') {
                data.rightEye = document.getElementById(`rightEyeDay${daySuffix}`)?.value;
                data.leftEye = document.getElementById(`leftEyeDay${daySuffix}`)?.value;
                data.glasses = document.querySelector(`input[name="glassesDay${daySuffix}"]:checked`)?.value;
            } else if (sectionName === 'hearing') {
                data.right1000 = document.querySelector(`input[name="hearingRight1000Day${daySuffix}"]:checked`)?.value;
                data.right2000 = document.querySelector(`input[name="hearingRight2000Day${daySuffix}"]:checked`)?.value;
                data.right4000 = document.querySelector(`input[name="hearingRight4000Day${daySuffix}"]:checked`)?.value;
                data.left1000 = document.querySelector(`input[name="hearingLeft1000Day${daySuffix}"]:checked`)?.value;
                data.left2000 = document.querySelector(`input[name="hearingLeft2000Day${daySuffix}"]:checked`)?.value;
                data.left4000 = document.querySelector(`input[name="hearingLeft4000Day${daySuffix}"]:checked`)?.value;
            }
            
            return data;
        }

        // Open section programmatically
        function openSection(sectionName) {
            const content = document.getElementById(`${sectionName}-content`);
            const icon = document.querySelector(`#${sectionName}Section .toggle-icon`);
            const header = document.querySelector(`#${sectionName}Section .section-header`);
                
                if (content) {
                    content.classList.add('open');
                if (icon) icon.textContent = '▼';
                if (header) header.classList.add('active');
            }
        }

        // Tab switching functionality
        function switchTab(tabName) {
            // Hide all tab panels
            document.getElementById('searchTabContent').style.display = 'none';
            document.getElementById('newStudentTabContent').style.display = 'none';
            
            // Remove active class from all tabs
            document.getElementById('searchTab').classList.remove('active');
            document.getElementById('newStudentTab').classList.remove('active');
            
            // Show selected tab and mark as active
            if (tabName === 'search') {
                document.getElementById('searchTabContent').style.display = 'block';
                document.getElementById('searchTab').classList.add('active');
            } else if (tabName === 'newStudent') {
                document.getElementById('newStudentTabContent').style.display = 'block';
                document.getElementById('newStudentTab').classList.add('active');
            }
            
            // Clear any previous student data when switching tabs
            clearForm();
        }

        function clearForm() {
            // Clear search fields
            document.getElementById('studentId').value = '';
            document.getElementById('searchLastName').value = '';
            document.getElementById('searchSchool').value = '';
            
            // Clear new student fields
            document.getElementById('newFirstName').value = '';
            document.getElementById('newLastName').value = '';
            document.getElementById('newGrade').value = '';
            document.getElementById('newGender').value = '';
            document.getElementById('newSchool').value = '';
            document.getElementById('newTeacher').value = '';
            document.getElementById('newDOB').value = '';
            document.getElementById('newStatus').value = '';
            
            // Clear student info fields
            document.getElementById('studentFirstName').value = '';
            document.getElementById('studentLastName').value = '';
            document.getElementById('studentGrade').value = '';
            document.getElementById('studentGender').value = '';
            document.getElementById('studentSchool').value = '';
            document.getElementById('studentTeacher').value = '';
            document.getElementById('studentDOB').value = '';
            document.getElementById('studentStatus').value = '';
            
            // Hide student info section
            document.getElementById('studentInfoSection').style.display = 'none';
            
            // Clear stored student data
            window.currentStudent = null;
        }

        // Search by ID function
        async function searchById() {
            const studentId = document.getElementById('studentId').value.trim();
            if (!studentId) {
                alert('Please enter a student ID');
                return;
            }

            console.log('Searching for student ID:', studentId); // DEBUG

            try {
                const response = await fetch(`${API_BASE}/students/${studentId}`);
                console.log('API Response status:', response.status); // DEBUG
                
                if (!response.ok) {
                    throw new Error('Student not found');
                }

                const data = await response.json();
                console.log('API Response data:', data); // DEBUG
                
                // Check if API returns student data directly or wrapped in a response object
                const student = data.student || data; // Handle both response formats
                console.log('Student object:', student); // DEBUG

                // Determine required screenings based on grade and gender
                const grade = parseInt(student.grade);
                const gender = student.gender?.toLowerCase();
                
                const requiredScreenings = {
                    vision: true, // All grades
                    hearing: true, // All grades
                    acanthosis: [1, 3, 5, 7, 9].includes(grade), // Specific grades
                    scoliosis: [5, 7, 9].includes(grade) && gender === 'female' // Specific grades + females only
                };
                
                console.log('Required screenings:', requiredScreenings); // DEBUG
                
                // Load student data and auto-open required sections
                loadStudentData(student, requiredScreenings);

            } catch (error) {
                console.error('Search error:', error); // DEBUG
                alert('Error: ' + error.message);
            }
        }

        // Search by name function
        async function searchByName() {
            const lastName = document.getElementById('searchLastName').value.trim();
            const school = document.getElementById('searchSchool').value;
            
            if (!lastName || !school) {
                alert('Please enter both last name and school');
                return;
            }

            try {
                const response = await fetch(`${API_BASE}/students/search?lastName=${encodeURIComponent(lastName)}&school=${encodeURIComponent(school)}`);
                if (!response.ok) {
                    throw new Error('No students found');
                }

                const students = await response.json();
                
                if (students.length === 0) {
                    alert('No students found with that name and school');
                    return;
                }
                
                if (students.length === 1) {
                    // Single result - load directly
                    const student = students[0];
                    const grade = parseInt(student.grade);
                    const gender = student.gender?.toLowerCase();
                    
                    const requiredScreenings = {
                        vision: true,
                        hearing: true,
                        acanthosis: [1, 3, 5, 7, 9].includes(grade),
                        scoliosis: [5, 7, 9].includes(grade) && gender === 'female'
                    };
                    
                    loadStudentData(student, requiredScreenings);
                } else {
                    // Multiple results - show selection
                    showSearchResults(students);
                }

            } catch (error) {
                alert('Error: ' + error.message);
            }
        }

        // Show multiple search results
        function showSearchResults(students) {
            const resultsDiv = document.getElementById('searchResults');
            resultsDiv.innerHTML = '<h4>Multiple students found. Please select:</h4>';
            
            students.forEach(student => {
                const studentDiv = document.createElement('div');
                studentDiv.className = 'student-result';
                studentDiv.innerHTML = `
                    <div class="student-info">
                        <strong>${student.first_name} ${student.last_name}</strong><br>
                        Grade: ${student.grade} | School: ${student.school_name}<br>
                        Student ID: ${student.student_id}
                    </div>
                    <button onclick="selectStudent('${student.student_id}')" class="select-button">Select</button>
                `;
                resultsDiv.appendChild(studentDiv);
            });
            
            resultsDiv.style.display = 'block';
        }

        // Select student from search results
        async function selectStudent(studentId) {
            try {
                const response = await fetch(`${API_BASE}/students/${studentId}`);
                const student = await response.json();
                
                const grade = parseInt(student.grade);
                const gender = student.gender?.toLowerCase();
                
                const requiredScreenings = {
                    vision: true,
                    hearing: true,
                    acanthosis: [1, 3, 5, 7, 9].includes(grade),
                    scoliosis: [5, 7, 9].includes(grade) && gender === 'female'
                };
                
                loadStudentData(student, requiredScreenings);
                
                // Hide search results
                document.getElementById('searchResults').style.display = 'none';
                
            } catch (error) {
                alert('Error loading student: ' + error.message);
            }
        }

        // Global variable to store current student data
        window.currentStudent = null;

        // Reset form to allow new student entry
        function resetForm() {
            // Clear student data
            window.currentStudent = null;
            
            // Clear all student info fields
            document.getElementById('firstName').value = '';
            document.getElementById('lastName').value = '';
            document.getElementById('grade').value = '';
            document.getElementById('gender').value = '';
            document.getElementById('school').value = '';
            document.getElementById('dateOfBirth').value = '';
            
            // Enable student ID field for new entry
            document.getElementById('studentId').disabled = false;
            document.getElementById('studentId').value = '';
            
            // Enable all student info fields for manual entry
            document.getElementById('firstName').readOnly = false;
            document.getElementById('lastName').readOnly = false;
            document.getElementById('grade').disabled = false;
            document.getElementById('gender').disabled = false;
            document.getElementById('school').disabled = false;
            document.getElementById('dateOfBirth').readOnly = false;
            
            // Close all screening sections
            document.querySelectorAll('.section-content').forEach(content => {
                    content.classList.remove('open');
            });
            document.querySelectorAll('.toggle-icon').forEach(icon => {
                icon.textContent = '▶';
            });
            document.querySelectorAll('.section-header').forEach(header => {
                        header.classList.remove('active');
            });
        }

        // Load student data and enable fields
        function loadStudentData(student, requiredScreenings) {
            console.log('Loading student data:', student); // DEBUG
            
            // Store student data globally
            window.currentStudent = student;
            
            // Get all student info fields
            const firstNameField = document.getElementById('studentFirstName');
            const lastNameField = document.getElementById('studentLastName');
            const gradeField = document.getElementById('studentGrade');
            const genderField = document.getElementById('studentGender');
            const schoolField = document.getElementById('studentSchool');
            const teacherField = document.getElementById('studentTeacher');
            const dobField = document.getElementById('studentDOB');
            const statusField = document.getElementById('studentStatus');
            
            // DEBUG: Check if fields exist
            console.log('Fields found:', {
                firstName: !!firstNameField,
                lastName: !!lastNameField,
                grade: !!gradeField,
                gender: !!genderField,
                school: !!schoolField,
                teacher: !!teacherField,
                dob: !!dobField,
                status: !!statusField
            });
            
            // Populate fields with student data
            if (firstNameField) firstNameField.value = student.first_name || '';
            if (lastNameField) lastNameField.value = student.last_name || '';
            if (gradeField) gradeField.value = student.grade || '';
            if (genderField) genderField.value = student.gender || '';
            if (schoolField) schoolField.value = student.school_name || '';
            if (teacherField) teacherField.value = student.teacher || '';
            if (dobField) dobField.value = student.date_of_birth || '';
            if (statusField) statusField.value = student.status || '';
            
            // Enable all fields (make editable)
            if (firstNameField) firstNameField.readOnly = false;
            if (lastNameField) lastNameField.readOnly = false;
            if (gradeField) gradeField.disabled = false;
            if (genderField) genderField.disabled = false;
            if (schoolField) schoolField.disabled = false;
            if (teacherField) teacherField.readOnly = false;
            if (dobField) dobField.readOnly = false;
            if (statusField) statusField.disabled = false;
            
            // Show student info section
            const studentInfoSection = document.getElementById('studentInfoSection');
            if (studentInfoSection) {
                studentInfoSection.style.display = 'block';
                console.log('Student info section shown'); // DEBUG
            }
            
            // Show success message
            const successBanner = document.createElement('div');
            successBanner.className = 'success-banner';
            successBanner.textContent = `✓ Loaded student: ${student.first_name} ${student.last_name} (${student.student_id || student.id})`;
            successBanner.style.cssText = 'background-color: #d4edda; color: #155724; padding: 15px; margin: 10px 0; border-radius: 5px; text-align: center; font-weight: bold;';
            
            const form = document.querySelector('form');
            form.insertBefore(successBanner, form.firstChild);
            
            // Remove banner after 3 seconds
            setTimeout(() => successBanner.remove(), 3000);
            
            // Auto-open required screening sections
            if (requiredScreenings) {
                console.log('Opening sections:', requiredScreenings); // DEBUG
                if (requiredScreenings.vision) openSection('vision');
                if (requiredScreenings.hearing) openSection('hearing');
                if (requiredScreenings.acanthosis) openSection('acanthosis');
                if (requiredScreenings.scoliosis) openSection('scoliosis');
            }
        }

        // Legacy search function - redirects to searchById
        async function searchStudent() {
            await searchById();
        }

        // Create new student function
        async function createNewStudent() {
            // Validate required fields
            const firstName = document.getElementById('newFirstName').value.trim();
            const lastName = document.getElementById('newLastName').value.trim();
            const grade = document.getElementById('newGrade').value;
            const gender = document.getElementById('newGender').value;
            const school = document.getElementById('newSchool').value;
            const dob = document.getElementById('newDOB').value;
            const status = document.getElementById('newStatus').value;
            
            if (!firstName || !lastName || !grade || !gender || !school || !dob || !status) {
                alert('Please fill in all required fields (marked with *)');
                return;
            }
            
            const teacher = document.getElementById('newTeacher').value.trim();
            
            try {
                const response = await fetch(`${API_BASE}/students`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        first_name: firstName,
                        last_name: lastName,
                        grade: grade,
                        gender: gender.toLowerCase(),
                        school_name: school,
                        teacher: teacher,
                        date_of_birth: dob,
                        status: status
                    })
                });
                
                const result = await response.json();
                
                if (response.ok) {
                    // Show success message with generated ID
                    alert(`Student created successfully!\nStudent ID: ${result.student_id || result.id}\nName: ${firstName} ${lastName}`);
                    
                    // Load student into form
                    window.currentStudent = result;
                    
                    // Determine required screenings
                    const gradeNum = parseInt(grade);
                    const genderLower = gender.toLowerCase();
                    
                    const requiredScreenings = {
                        vision: true,
                        hearing: true,
                        acanthosis: [1, 3, 5, 7, 9].includes(gradeNum),
                        scoliosis: [5, 7, 9].includes(gradeNum) && genderLower === 'female'
                    };
                    
                    loadStudentData(result, requiredScreenings);
                    
                    // Show student info section
                    document.getElementById('studentInfoSection').style.display = 'block';
                    
                    // Switch back to search tab
                    switchTab('search');
                    
                } else {
                    alert('Error creating student: ' + (result.error || 'Unknown error'));
                }
                
            } catch (error) {
                console.error('Error creating student:', error);
                alert('Error creating student. Please try again.');
            }
        }

        // Form submission
        async function submitForm(event) {
            event.preventDefault();

            let studentId;
            
            // Check if we have a searched student or need to create a new one
            if (window.currentStudent) {
                // Use existing student ID
                studentId = window.currentStudent.id || window.currentStudent.student_id;
            } else {
                // Create new student
                const newStudent = await createNewStudent();
                if (!newStudent) return; // Creation failed
                studentId = newStudent.id || newStudent.student_id;
                window.currentStudent = newStudent;
            }
            
            if (!studentId) {
                alert('Please search for a student or create a new one');
                return;
            }

            // Build screening payload (NO student demographic data)
            const formData = {
                student_id: studentId,
                absent: document.querySelector('input[name="absent"]:checked')?.value,
                screening_type: document.querySelector('input[name="screeningType"]:checked')?.value,
                vision: isSectionOpen('vision') ? gatherScreeningData('vision') : null,
                hearing: isSectionOpen('hearing') ? gatherScreeningData('hearing') : null,
                acanthosis: isSectionOpen('acanthosis') ? gatherScreeningData('acanthosis') : null,
                scoliosis: isSectionOpen('scoliosis') ? gatherScreeningData('scoliosis') : null
            };

            try {
                const response = await fetch(`${API_BASE}/screenings`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(formData)
                });

                if (response.ok) {
                    alert('Screening results submitted successfully!');
                    // Optionally reset the form or redirect
                } else {
                    throw new Error('Failed to submit screening results');
                }
            } catch (error) {
                alert('Error: ' + error.message);
            }
        }

        // Validation functions
        function validateVisionSection(errors) {
            const visionContent = document.getElementById('vision-content');
            if (!visionContent.classList.contains('open')) return;
            
            const screeningType = document.querySelector('input[name="screeningType"]:checked').value;
            const daySuffix = screeningType === 'day1' ? '1' : '2';
            
            if (!document.querySelector(`input[name="visionDay${daySuffix}Type"]:checked`)) {
                errors.push(`Vision Screening - ${screeningType === 'day1' ? 'Initial' : 'Rescreen'}: Please select Screening Type`);
            }
            if (!document.getElementById(`visionScreener${daySuffix}`).value) {
                errors.push(`Vision Screening - ${screeningType === 'day1' ? 'Initial' : 'Rescreen'}: Please select a Screener`);
            }
            if (!document.querySelector(`input[name="glassesDay${daySuffix}"]:checked`)) {
                errors.push(`Vision Screening - ${screeningType === 'day1' ? 'Initial' : 'Rescreen'}: Please select if wearing glasses/contacts`);
            }
            const rightEye = document.getElementById(`rightEyeDay${daySuffix}`).value;
            const leftEye = document.getElementById(`leftEyeDay${daySuffix}`).value;
                if (!rightEye) {
                errors.push(`Vision Screening - ${screeningType === 'day1' ? 'Initial' : 'Rescreen'}: Please enter Right Eye Acuity`);
                }
                if (!leftEye) {
                errors.push(`Vision Screening - ${screeningType === 'day1' ? 'Initial' : 'Rescreen'}: Please enter Left Eye Acuity`);
                }
            if (!document.querySelector(`input[name="visionResultDay${daySuffix}"]:checked`)) {
                errors.push(`Vision Screening - ${screeningType === 'day1' ? 'Initial' : 'Rescreen'}: Please select Pass/Fail result`);
            }
        }

        function validateHearingSection(errors) {
            const hearingContent = document.getElementById('hearing-content');
            if (!hearingContent.classList.contains('open')) return;
            
            const screeningType = document.querySelector('input[name="screeningType"]:checked').value;
            const daySuffix = screeningType === 'day1' ? '1' : '2';
            
            if (!document.querySelector(`input[name="hearingDay${daySuffix}Type"]:checked`)) {
                errors.push(`Hearing Screening - ${screeningType === 'day1' ? 'Initial' : 'Rescreen'}: Please select Screening Type`);
            }
            if (!document.getElementById(`hearingScreener${daySuffix}`).value) {
                errors.push(`Hearing Screening - ${screeningType === 'day1' ? 'Initial' : 'Rescreen'}: Please select a Screener`);
                }
                
                const frequencies = ['1000', '2000', '4000'];
                frequencies.forEach(freq => {
                if (!document.querySelector(`input[name="hearingRight${freq}Day${daySuffix}"]:checked`)) {
                    errors.push(`Hearing Screening - ${screeningType === 'day1' ? 'Initial' : 'Rescreen'}: Please select Pass/Fail for Right Ear ${freq} Hz`);
                    }
                if (!document.querySelector(`input[name="hearingLeft${freq}Day${daySuffix}"]:checked`)) {
                    errors.push(`Hearing Screening - ${screeningType === 'day1' ? 'Initial' : 'Rescreen'}: Please select Pass/Fail for Left Ear ${freq} Hz`);
                    }
                });
                
            if (!document.querySelector(`input[name="hearingResultDay${daySuffix}"]:checked`)) {
                errors.push(`Hearing Screening - ${screeningType === 'day1' ? 'Initial' : 'Rescreen'}: Please select Overall Pass/Fail result`);
            }
        }

        function validateAcanthosisSection(errors) {
            const acanthosisContent = document.getElementById('acanthosis-content');
            if (!acanthosisContent.classList.contains('open')) return;
            
            const screeningType = document.querySelector('input[name="screeningType"]:checked').value;
            const daySuffix = screeningType === 'day1' ? '1' : '2';
            
            if (!document.querySelector(`input[name="acanthosisDay${daySuffix}Type"]:checked`)) {
                errors.push(`Acanthosis Nigricans - ${screeningType === 'day1' ? 'Initial' : 'Rescreen'}: Please select Screening Type`);
            }
            if (!document.getElementById(`acanthosisScreener${daySuffix}`).value) {
                errors.push(`Acanthosis Nigricans - ${screeningType === 'day1' ? 'Initial' : 'Rescreen'}: Please select a Screener`);
            }
            if (!document.querySelector(`input[name="acanthosisResultDay${daySuffix}"]:checked`)) {
                errors.push(`Acanthosis Nigricans - ${screeningType === 'day1' ? 'Initial' : 'Rescreen'}: Please select Pass/Fail result`);
            }
        }

        function validateScoliosisSection(errors) {
            const scoliosisContent = document.getElementById('scoliosis-content');
            if (!scoliosisContent.classList.contains('open')) return;
            
            const screeningType = document.querySelector('input[name="screeningType"]:checked').value;
            const daySuffix = screeningType === 'day1' ? '1' : '2';
            
            if (!document.querySelector(`input[name="scoliosisDay${daySuffix}Type"]:checked`)) {
                errors.push(`Scoliosis Screening - ${screeningType === 'day1' ? 'Initial' : 'Rescreen'}: Please select Screening Type`);
            }
            if (!document.getElementById(`scoliosisScreener${daySuffix}`).value) {
                errors.push(`Scoliosis Screening - ${screeningType === 'day1' ? 'Initial' : 'Rescreen'}: Please select a Screener`);
            }
            if (!document.querySelector(`input[name="scoliosisResultDay${daySuffix}"]:checked`)) {
                errors.push(`Scoliosis Screening - ${screeningType === 'day1' ? 'Initial' : 'Rescreen'}: Please select Pass/Fail result`);
            }
        }

        // Form validation
        function validateForm() {
            const errors = [];
            
            // Check if student ID is provided
            if (!document.getElementById('studentId').value.trim()) {
                errors.push('Please enter a student ID');
            }
            
            // Validate only open sections
            validateVisionSection(errors);
            validateHearingSection(errors);
            validateAcanthosisSection(errors);
            validateScoliosisSection(errors);
            
            return errors;
        }

        // Load schools list
        async function loadSchools() {
            try {
                const response = await fetch(`${API_BASE}/schools`);
                if (response.ok) {
                    const data = await response.json();
                    
                    // Populate search dropdown
                    const searchSelect = document.getElementById('searchSchool');
                    searchSelect.innerHTML = '<option value="">Select School</option>';
                    data.schools.forEach(school => {
                        const option = document.createElement('option');
                        option.value = school.name;
                        option.textContent = school.name;
                        searchSelect.appendChild(option);
                    });
                    
                    // Populate new student dropdown
                    const newStudentSelect = document.getElementById('newSchool');
                    newStudentSelect.innerHTML = '<option value="">Select School</option>';
                    data.schools.forEach(school => {
                        const option = document.createElement('option');
                        option.value = school.name;
                        option.textContent = school.name;
                        newStudentSelect.appendChild(option);
                    });
                    
                    // Populate student info section dropdown
                    const studentInfoSelect = document.getElementById('studentSchool');
                    studentInfoSelect.innerHTML = '<option value="">Select School</option>';
                    data.schools.forEach(school => {
                        const option = document.createElement('option');
                        option.value = school.name;
                        option.textContent = school.name;
                        studentInfoSelect.appendChild(option);
                    });
                    
                    console.log('Schools loaded successfully:', data.schools.length, 'schools'); // DEBUG
                }
            } catch (error) {
                console.error('Error loading schools:', error);
            }
        }

        // Initialize everything when DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            initializeCollapsibleSections();
            initializeScreeningTypeListener();
            loadSchools();
            
            // Set default date to today
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('globalDate').value = today;
            
            // Add form submission handler
            document.getElementById('screeningForm').addEventListener('submit', function(event) {
                const errors = validateForm();
                if (errors.length > 0) {
                    event.preventDefault();
                    alert('Please fix the following errors:\n\n' + errors.join('\n'));
                } else {
                    submitForm(event);
                }
            });
        });
    </script>
</body>
</html>